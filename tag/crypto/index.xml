<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Crypto | Daniel Uroz</title>
    <link>https://duroz.github.io/tag/crypto/</link>
      <atom:link href="https://duroz.github.io/tag/crypto/index.xml" rel="self" type="application/rss+xml" />
    <description>Crypto</description>
    <generator>Wowchemy (https://wowchemy.com)</generator><language>en-us</language><lastBuildDate>Tue, 19 May 2020 00:00:00 +0000</lastBuildDate>
    <image>
      <url>https://duroz.github.io/media/icon_hu235ca53f37dee462d16f210e413d062e_29183_512x512_fill_lanczos_center_3.png</url>
      <title>Crypto</title>
      <link>https://duroz.github.io/tag/crypto/</link>
    </image>
    
    <item>
      <title>247/CTF - Crypto - An Exclusive Key</title>
      <link>https://duroz.github.io/post/247ctf-crypto-exclusive-key/</link>
      <pubDate>Tue, 19 May 2020 00:00:00 +0000</pubDate>
      <guid>https://duroz.github.io/post/247ctf-crypto-exclusive-key/</guid>
      <description>&lt;p&gt;Hi all! This is my first blog post ever, I&amp;rsquo;ll try to write every post self-explanatory and explain every detail involved. This time is about the third challenge of cryptography of the platform &lt;a href=&#34;https://247ctf.com/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;247/CTF&lt;/a&gt;.&lt;/p&gt;
&lt;h2 id=&#34;challenge-description&#34;&gt;Challenge description&lt;/h2&gt;
&lt;p&gt;We&amp;rsquo;re given an exclusive_key file with the following description:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;We XOR encrypted this file, but forgot to save the password. Can you recover the password for us and find the flag?&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;At first sight, we can&amp;rsquo;t see any repetition, so it seems there is no clue about what xor key was used for encryption:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ md5sum exclusive_key
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;e1078ca347364828a43a40bd55c937f2  exclusive_key
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ xxd exclusive_key &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; head
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;00000000: 0e15 730c &lt;span class=&#34;m&#34;&gt;1712&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;2233&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;2718&lt;/span&gt; 5a15 5f5d 5c68  ..s...&lt;span class=&#34;s2&#34;&gt;&amp;#34;3&amp;#39;.Z._]\h
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s2&#34;&gt;00000010: 050b 405b 5914 065d 5846 400b 4100 090a  ..@[Y..]XF@.A...
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s2&#34;&gt;00000020: 570c 4015 085b 5d0e 1014 5b22 3a21 4641  W.@..[]...[&amp;#34;&lt;/span&gt;:!FA
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;00000030: &lt;span class=&#34;m&#34;&gt;0756&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1041&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;5658&lt;/span&gt; 105f 1b0f &lt;span class=&#34;m&#34;&gt;4044&lt;/span&gt; 170a 6f0d  .V.AVX._..@D..o.
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;00000040: &lt;span class=&#34;m&#34;&gt;5150&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;5252&lt;/span&gt; 5d69 590e &lt;span class=&#34;m&#34;&gt;5716&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;5518&lt;/span&gt; 055c 560f  QPRR&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;iY.W.U..&lt;span class=&#34;se&#34;&gt;\V&lt;/span&gt;.
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;00000050: &lt;span class=&#34;m&#34;&gt;4151&lt;/span&gt; 437e &lt;span class=&#34;m&#34;&gt;7613&lt;/span&gt; 2f25 4f00 104e 0c3b 5e16  AQC~v./%O..N.&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;^.
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;00000060: &lt;span class=&#34;m&#34;&gt;5017&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;5853&lt;/span&gt; 0b7c &lt;span class=&#34;m&#34;&gt;0452&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;5250&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;4116&lt;/span&gt; 4e43 320a  P.XS.&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;.RRPA.NC2.
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;00000070: 590b 445d 025d &lt;span class=&#34;m&#34;&gt;5641&lt;/span&gt; 1d40 5e37 &lt;span class=&#34;m&#34;&gt;3823&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;4569&lt;/span&gt;  Y.D&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;.&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;VA.@^78#Ei
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;00000080: 5e4b &lt;span class=&#34;m&#34;&gt;5113&lt;/span&gt; 5b41 165c 5d0c &lt;span class=&#34;m&#34;&gt;5743&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;5851&lt;/span&gt; 0b45  ^KQ.&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;A.&lt;span class=&#34;se&#34;&gt;\]&lt;/span&gt;.WCXQ.E
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;00000090: &lt;span class=&#34;m&#34;&gt;1751&lt;/span&gt; 5c55 160e 000d &lt;span class=&#34;m&#34;&gt;4627&lt;/span&gt; 585d 0b51 &lt;span class=&#34;m&#34;&gt;5909&lt;/span&gt;  .Q&lt;span class=&#34;se&#34;&gt;\U&lt;/span&gt;....F&lt;span class=&#34;err&#34;&gt;&amp;#39;&lt;/span&gt;X&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;.QY.
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;solution&#34;&gt;Solution&lt;/h2&gt;
&lt;p&gt;If we Google a bit, we encounter an amazing tool to analyze multi-byte xor cipher called &lt;a href=&#34;https://github.com/hellman/xortool&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;xortool&lt;/a&gt; able to:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;guess the key length (based on count of equal chars)&lt;/li&gt;
&lt;li&gt;guess the key (base on knowledge of most frequent char)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;If we run the tool with default settings, it outputs the following results:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ xortool exclusive_key
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;The most probable key lengths:
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    2:   13.4%
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    4:   13.7%
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    8:   13.4%
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    10:   11.9%
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    12:   9.4%
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    16:   9.1%
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    18:   6.4%
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    20:   9.4%
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    24:   6.5%
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    40:   7.0%
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Key-length can be 4*n
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Most possible char is needed to guess the key!
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Well, better than nothing. We can specify the most possible character with &lt;code&gt;-c&lt;/code&gt; option, usually is &lt;code&gt;0x00&lt;/code&gt; (null-byte) for binary data and &lt;code&gt;0x20&lt;/code&gt; (whitespace) for text data. If we try either of the two, we obtain a similar result:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ xortool exclusive_key -c &lt;span class=&#34;s2&#34;&gt;&amp;#34;0x00&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;The most probable key lengths:
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    2:   13.4%
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    4:   13.7%
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    8:   13.4%
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    10:   11.9%
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    12:   9.4%
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    16:   9.1%
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    18:   6.4%
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    20:   9.4%
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    24:   6.5%
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    40:   7.0%
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Key-length can be 4*n
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; possible key&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;s&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; of length 4:
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;][&lt;/span&gt;_
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Found &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; plaintexts with 95%+ valid characters
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;See files filename-key.csv, filename-char_used-perc_valid.csv
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;The tool will create the folder xortool_out with three files in this case:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;0.out&lt;/strong&gt;: decrypted file with guessed xor key.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;filename-char_used-perc_valid.csv&lt;/strong&gt;: list of most frequent char used for every file (in case of many) and percentage of valid characters in the decrypted file.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;filename-key.csv&lt;/strong&gt;: list of key used for every file.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Unfortunately, the resulting file doesn&amp;rsquo;t seem to have been decrypted right:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ xxd xortool_out/0.out &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; head
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;00000000: &lt;span class=&#34;m&#34;&gt;5248&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;2853&lt;/span&gt; 4b4f 796c 7b45 014a &lt;span class=&#34;m&#34;&gt;0300&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;0737&lt;/span&gt;  RH&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;SKOyl&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;E.J...7
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;00000010: &lt;span class=&#34;m&#34;&gt;5956&lt;/span&gt; 1b04 &lt;span class=&#34;m&#34;&gt;0549&lt;/span&gt; 5d02 041b 1b54 1d5d &lt;span class=&#34;m&#34;&gt;5255&lt;/span&gt;  YV...I&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;....T.&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;RU
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;00000020: 0b51 1b4a &lt;span class=&#34;m&#34;&gt;5406&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;0651&lt;/span&gt; 4c49 007d 667c 1d1e  .Q.JT..QLI.&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;f&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;..
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;00000030: 5b0b 4b1e 0a05 4b00 &lt;span class=&#34;m&#34;&gt;4752&lt;/span&gt; 1b1b 4b57 &lt;span class=&#34;m&#34;&gt;3452&lt;/span&gt;  &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;.K...K.GR..KW4R
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;00000040: 0d0d 090d &lt;span class=&#34;m&#34;&gt;0134&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;0251&lt;/span&gt; 0b4b 0e47 &lt;span class=&#34;m&#34;&gt;5901&lt;/span&gt; 0d50  .....4.Q.K.GY..P
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;00000050: 1d0c &lt;span class=&#34;m&#34;&gt;1821&lt;/span&gt; 2a4e 747a 135d 4b11 &lt;span class=&#34;m&#34;&gt;5066&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;0549&lt;/span&gt;  ...!*Ntz.&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;K.Pf.I
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;00000060: 0c4a 030c &lt;span class=&#34;m&#34;&gt;5721&lt;/span&gt; 5f0d 0e0d 1a49 121e &lt;span class=&#34;m&#34;&gt;6955&lt;/span&gt;  .J..W!_....I..iU
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;00000070: &lt;span class=&#34;m&#34;&gt;0556&lt;/span&gt; 1f02 5e00 0d1e 411d &lt;span class=&#34;m&#34;&gt;0568&lt;/span&gt; 647e 1e36  .V..^...A..hd~.6
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;00000080: &lt;span class=&#34;m&#34;&gt;0216&lt;/span&gt; 0a4c 071c 4d03 &lt;span class=&#34;m&#34;&gt;0151&lt;/span&gt; 0c1c 040c 501a  ...L..M..Q....P.
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;00000090: 4b0c 070a 4a53 5b52 1a7a &lt;span class=&#34;m&#34;&gt;0302&lt;/span&gt; 570c &lt;span class=&#34;m&#34;&gt;0256&lt;/span&gt;  K...JS&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;R.z..W..V
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;So, we can try to bruteforce the key. The tools counts with &lt;code&gt;-b&lt;/code&gt; option to brute force all possible most frequent chars, or &lt;code&gt;-o&lt;/code&gt; to constraint search to printable chars. If we try to run either of two options, we get a bunch of files with no sense at all. But, if we use &lt;code&gt;-m&lt;/code&gt; option to specify a longer key, we obtain a more promising result:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ xortool exclusive_key -o -m &lt;span class=&#34;m&#34;&gt;256&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;The most probable key lengths:
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    2:   9.5%
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    4:   10.2%
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    8:   11.4%
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    10:   10.8%
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    12:   9.1%
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    16:   9.9%
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    20:   11.3%
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    24:   8.5%
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    30:   7.5%
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    40:   11.8%
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Key-length can be 4*n
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;m&#34;&gt;100&lt;/span&gt; possible key&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;s&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; of length 40:
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;gab\x16\x01\x13.67mg4kd77l:ac`a0dl`#c6606gram3ab(
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;f&lt;span class=&#34;sb&#34;&gt;`&lt;/span&gt;c&lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;17&lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;00&lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;12/76lf5je66m&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;sb&#34;&gt;`&lt;/span&gt;ba&lt;span class=&#34;sb&#34;&gt;`&lt;/span&gt;1ema&lt;span class=&#34;s2&#34;&gt;&amp;#34;b7717fs`l2`c)
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#39;ec`\x14\x03\x11,45oe6if55n8cabc2fnb!a4424epco1c`*
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#39;dba\x15\x02\x10-54nd7hg44o9b`cb3goc `5535dqbn0ba+
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;cef&lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;12&lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;05&lt;span class=&#34;se&#34;&gt;\x&lt;/span&gt;17*23ic0o&lt;span class=&#34;sb&#34;&gt;`&lt;/span&gt;33h&amp;gt;egde4&lt;span class=&#34;sb&#34;&gt;`&lt;/span&gt;hd&lt;span class=&#34;err&#34;&gt;&amp;#39;&lt;/span&gt;g2242cvei7ef,
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;...
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Found &lt;span class=&#34;m&#34;&gt;35&lt;/span&gt; plaintexts with 95%+ valid characters
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;See files filename-key.csv, filename-char_used-perc_valid.csv
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;35 plaintext!&lt;/strong&gt; If we carefully examine the 99 resulting files, we can spot an almost decrypted HTML file of &lt;a href=&#34;https://en.wikipedia.org/wiki/Hacker&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Wikipedia&amp;rsquo;s hacker entry&lt;/a&gt; in &lt;code&gt;14.out&lt;/code&gt; file:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ xxd xortool_out/14.out &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; head
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;00000000: 3c21 444f &lt;span class=&#34;m&#34;&gt;4354&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;5950&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;4520&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;6874&lt;/span&gt; 616c 3e0a  &amp;lt;!DOCTYPE htal&amp;gt;.
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;00000010: 3c64 746d 6c20 636c &lt;span class=&#34;m&#34;&gt;6173&lt;/span&gt; 363d &lt;span class=&#34;m&#34;&gt;2263&lt;/span&gt; 6c69  &amp;lt;dtml &lt;span class=&#34;nv&#34;&gt;clas6&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;cli
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s2&#34;&gt;00000020: 652b 742d 6e6f 6a73 2220 6c61 6e67 3d22  e+t-nojs&amp;#34;&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;lang&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s2&#34;&gt;00000030: 656e 2220 6869 723d 2260 7472 223e 0a3c  en&amp;#34;&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;hir&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;`tr&amp;#34;&lt;/span&gt;&amp;gt;.&amp;lt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;00000040: &lt;span class=&#34;m&#34;&gt;6865&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;2464&lt;/span&gt; 3e0a 3c6d &lt;span class=&#34;m&#34;&gt;6531&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;6120&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;6368&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;6172&lt;/span&gt;  he&lt;span class=&#34;nv&#34;&gt;$d&lt;/span&gt;&amp;gt;.&amp;lt;me1a char
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;00000050: &lt;span class=&#34;m&#34;&gt;7365&lt;/span&gt; 743d &lt;span class=&#34;m&#34;&gt;2255&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;5446&lt;/span&gt; 2d38 222f 320a 3c74  &lt;span class=&#34;nv&#34;&gt;set&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;UTF-8&amp;#34;&lt;/span&gt;/2.&amp;lt;t
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;00000060: &lt;span class=&#34;m&#34;&gt;6978&lt;/span&gt; 6c65 3e48 &lt;span class=&#34;m&#34;&gt;6163&lt;/span&gt; 6b65 &lt;span class=&#34;m&#34;&gt;3720&lt;/span&gt; 2d20 &lt;span class=&#34;m&#34;&gt;5769&lt;/span&gt;  ixle&amp;gt;Hacke7 - Wi
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;00000070: 6b2c &lt;span class=&#34;m&#34;&gt;7065&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;6469&lt;/span&gt; 613c 2f74 &lt;span class=&#34;m&#34;&gt;6974&lt;/span&gt; 6c65 3e0a  k,pedia&amp;lt;/title&amp;gt;.
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;00000080: 3c73 &lt;span class=&#34;m&#34;&gt;6372&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;6570&lt;/span&gt; 743e &lt;span class=&#34;m&#34;&gt;6463&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;6375&lt;/span&gt; 6d65 6e74  &amp;lt;scrept&amp;gt;dccument
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;00000090: 2e64 2a63 756d 656e &lt;span class=&#34;m&#34;&gt;7400&lt;/span&gt; 6c65 6d65 6e74  .d*cument.lement
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;And if we examine the key used for that file, we can see that it follows the &lt;strong&gt;flag structure &lt;code&gt;247CTF{XXX}&lt;/code&gt;&lt;/strong&gt;, but it contains some bytes out of the md5 hexstring hash range (&lt;code&gt;[a-f0-9]&lt;/code&gt;). As we already know both the cipher and plain text, we can xor them to obtain the right key:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;In&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]:&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;with&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;open&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;Hacker - Wikipedia.html&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;rb&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;as&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;...&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;     &lt;span class=&#34;n&#34;&gt;plain&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;read&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;...&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;In&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]:&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;with&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;open&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;exclusive_key&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;rb&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;as&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;...&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;     &lt;span class=&#34;n&#34;&gt;cipher&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;read&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;...&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;In&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]:&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;join&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;([&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;chr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;^&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;c&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;zip&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;plain&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[:&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;40&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;cipher&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[:&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;40&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])])&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;Out&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]:&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;247CTF&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;{XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX}&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;And the flag!&lt;/p&gt;
</description>
    </item>
    
  </channel>
</rss>
